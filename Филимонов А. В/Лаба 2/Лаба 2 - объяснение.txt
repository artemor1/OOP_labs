# Лаба 2: как устроен проект

> Примечание: в репозиторий добавлена только Markdown-версия, чтобы избежать ошибки «Бинарные файлы не поддерживаются» в PR.
> Для получения .docx запустите: python generate_docx_from_md.py в папке Филимонов А. В/Лаба 2.

## 1. Общая идея лабораторной
Лабораторная 2 построена вокруг представления векторов и сигналов через комплексные числа. Проект включает:
- математическое ядро (MyComplex, MyComplexSignal),
- интерфейс для вычислений и ввода данных (Form2),
- интерфейс визуализации сигнала на координатной сетке (Form1).

Логика организована так: пользователь вводит комплексные значения в Form2, затем Form1 получает сигнал, применяет преобразования (масштаб, поворот, ДПФ/ОДПФ, нормировку) и рисует контур на холсте.

## 2. Класс MyComplex (базовый строительный блок)

### 2.1 Что хранит
MyComplex хранит два поля:
- re — действительная часть,
- im — мнимая часть.

Также есть свойства X и Y как обёртка над теми же значениями.

### 2.2 Основные операции
Класс поддерживает ключевые действия с комплексными числами:
- модуль числа Abs(),
- сложение/вычитание (+, -),
- умножение двух комплексных чисел (*),
- умножение на число (complex * double),
- деление на число (complex / double),
- скалярное произведение двух векторов ScalarDot,
- поворот вектора на угол в радианах Rotate.

Благодаря перегрузке операторов код выше по уровню (MyComplexSignal) читается компактно: формулы выглядят почти как в математике.

### 2.3 Парсинг строк
Метод Parse(string) позволяет вводить значения вручную (например, 3+2i, -1.5-4i, 2i, 5).
Особенности:
- удаляются пробелы,
- точка заменяется на запятую (адаптация под текущую культуру парсинга),
- строка делится на реальную и мнимую части,
- при некорректном формате возвращается fallback-значение.

Это критично для UI, потому что данные в таблице (DataGridView) вводятся как строки.

## 3. Класс MyComplexSignal (работа с набором точек/векторов)

### 3.1 Что такое сигнал в этой лабораторной
MyComplexSignal — это список List<MyComplex>, где каждый элемент можно трактовать как:
- точку в плоскости,
- либо очередной вектор контура,
- либо отсчёт сигнала для спектральной обработки.

### 3.2 Норма и нормализация
- GetNorm() считает среднее значение модулей всех элементов сигнала.
- Normalize() масштабирует каждый элемент на коэффициент 1 / norm.

Смысл: привести сигнал к сопоставимому масштабу после операций (например, после ДПФ/ОДПФ).

### 3.3 Геометрические и алгебраические операции
Класс содержит методы высокого уровня:
- Scale — масштабирование сигнала,
- Rotate — поворот всех элементов на угол,
- Move — сдвиг на комплексный вектор,
- Conjugate — сопряжение,
- Sum, Sub, Mult — поэлементные операции через общий шаблон MathAction,
- Scalar — скалярное произведение двух сигналов.

Идея MathAction: один универсальный цикл + переданная функция (Func<MyComplex, MyComplex, MyComplex>), чтобы не дублировать код.

### 3.4 Конвертация для графики и таблицы
- ToPointF() / FromPointF() связывают математику с System.Drawing.
- ToString(MyComplexSignal) превращает сигнал в список строк для таблицы.
- Parse(List<string>) делает обратное преобразование.

Это «мост» между ядром и формами приложения.

### 3.5 DFT и IDFT
В лабораторной есть реализация:
- DFT — дискретного преобразования Фурье,
- IDFT — обратного преобразования.

Схема стандартная: двойной цикл по k и n, вычисление комплексного множителя exp(±j*2πkn/N) через cos и sin, суммирование и последующая нормализация.

Практический эффект:
- можно перейти от временного/геометрического представления сигнала к частотному,
- и затем вернуть сигнал обратно.

## 4. Важные части UI и потока данных

### 4.1 Form2 — ввод и редактирование
Form2 отвечает за:
- ручной ввод комплексных чисел,
- простые операции калькулятора над двумя числами,
- добавление значений в таблицу,
- генерацию контура по параметрам (k, m).

Через события DataRequested и ListDataRequested форма передаёт данные в Form1.

### 4.2 Form1 — визуализация
Form1:
- хранит текущий MyComplexSignal,
- рисует сетку и оси (Canvas.DrawGrid),
- строит контур как последовательность стрелок (Canvas.DrawContour),
- реагирует на команды меню: rotate, scale, normalize, DFT, IDFT, смещение.

Преобразования применяются к сигналу, затем данные отражаются и на рисунке, и обратно в таблице Form2.

## 5. Ключевая архитектурная мысль
Главная сильная сторона Лабы 2 — чёткое разделение уровней:
1. **Математика** (MyComplex, MyComplexSignal) — ничего не знает о кнопках и окнах.
2. **Представление данных** (строки, PointF) — адаптер между логикой и UI.
3. **Интерфейс** (Form1, Form2) — только ввод, отображение и вызов операций.

Из-за этого проект легко расширять:
- добавлять новые операции в MyComplexSignal,
- не переписывая большую часть визуальной части.

## 6. Что важно понимать при защите
Если коротко, Лаба 2 показывает три вещи:
- как комплексные числа используются как векторы на плоскости,
- как над массивами комплексных чисел выполнять групповые операции,
- как связать математическое ядро с интерактивным GUI и визуализацией.

Минимальный набор, который стоит уверенно объяснить:
1. устройство MyComplex и формулы операций;
2. зачем MyComplexSignal и как работает MathAction;
3. как устроены DFT/IDFT и зачем нужна нормализация;
4. как данные проходят путь: **таблица (Form2) → сигнал (MyComplexSignal) → графика (Form1)**.
